---
title: "Narrowing TypeScript"
description: "Sau một khoảng thời gian làm typescript, tự nhận là gà typescript thì mình khá ít dùng type unions. Hôm nay tranh thủ ngồi đọc các cách để narrowing type trong typescript."
date: "2024-06-02"
tags: ["typescript"]
cover: "/assets/2024/06/typescript.png"
---

Sau một khoảng thời gian làm typescript, tự nhận là gà typescript thì mình khá ít dùng type unions. Hôm nay tranh thủ ngồi đọc các cách để narrowing type trong typescript.

## typeof type guards

```typescript
const fn = (x: number | string) => {
    if (typeof x === 'number') {
        return x + 1; // x is number
    }
    return -1;
};
```

## Truthiness narrowing


```typescript
const toUpperCase = (name: string | null) => {
    if (name) {
        return name.toUpperCase();
    } else {
        return null;
    }
};
```

## Equality narrowing

```typescript
const checkStatus = (status: 'success' | 'error') => {
    switch (status) {
        case 'success':
            return true;
        case 'error':
            return null;
    }
};
```

## instanceof narrowing

Nếu sử dụng dụng union type là class, ta có thể sử dụng  <Notation type="underline" color="red"> `instanceof` </Notation> để kiểm tra kiểu của biến.

```typescript
class Square {
    constructor(public width: number) {}
}
class Rectangle {
    constructor(
        public width: number,
        public height: number
    ) {}
}
function area(shape: Square | Rectangle) {
    if (shape instanceof Square) {
        return shape.width * shape.width;
    } else {
        return shape.width * shape.height;
    }
}
const square = new Square(5);
const rectangle = new Rectangle(5, 10);
console.log(area(square)); // 25
console.log(area(rectangle)); // 50
```


## Discriminated Unions

```typescript
type Square = {
    kind: 'square'; // Discriminant
    size: number;
};

type Circle = {
    kind: 'circle'; // Discriminant
    radius: number;
};

type Shape = Square | Circle;

const area = (shape: Shape) => {
    switch (shape.kind) {
        case 'square':
            return Math.pow(shape.size, 2);
        case 'circle':
            return Math.PI * Math.pow(shape.radius, 2);
    }
};

const square: Square = { kind: 'square', size: 5 };
const circle: Circle = { kind: 'circle', radius: 2 };

console.log(area(square)); // 25
console.log(area(circle)); // 12.566370614359172
```